<UserControl x:Class="Agt.Desktop.Views.FormView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:Agt.Desktop.Views"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d">
    <UserControl.Resources>
        <!-- Šablony pro jednotlivé typy polí -->
        <DataTemplate x:Key="TextTemplate">
            <StackPanel Margin="0,6">
                <TextBlock Text="{Binding Field.Label}" Margin="0,0,0,2"/>
                <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate x:Key="NumberTemplate">
            <StackPanel Margin="0,6">
                <TextBlock Text="{Binding Field.Label}" Margin="0,0,0,2"/>
                <TextBox Text="{Binding Value, Mode=TwoWay}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate x:Key="DateTemplate">
            <StackPanel Margin="0,6">
                <TextBlock Text="{Binding Field.Label}" Margin="0,0,0,2"/>
                <DatePicker SelectedDate="{Binding Value, Mode=TwoWay}"/>
            </StackPanel>
        </DataTemplate>


        <!-- Výběr šablony podle Field.Type -->
        <local:FieldTemplateSelector x:Key="FieldSelector"
TextTemplate="{StaticResource TextTemplate}"
NumberTemplate="{StaticResource NumberTemplate}"
DateTemplate="{StaticResource DateTemplate}"/>
    </UserControl.Resources>


    <DockPanel Margin="12">
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,8">
            <Button Content="Načíst" Command="{Binding LoadAsyncCommand}" Margin="0,0,8,0"/>
            <Button Content="Uložit" Command="{Binding SaveAsyncCommand}"/>
            <TextBlock Text="{Binding StatusMessage}" Margin="12,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>


        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Fields}"
ItemTemplateSelector="{StaticResource FieldSelector}"/>
        </ScrollViewer>
    </DockPanel>
</UserControl>