<UserControl x:Class="Agt.Desktop.Views.PropertiesPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:m="clr-namespace:Agt.Desktop.Models"
             xmlns:conv="clr-namespace:Agt.Desktop.Converters">
    <Grid Margin="10">
        <!-- Nic vybráno -->
        <StackPanel Visibility="{Binding Source={StaticResource SelectionService}, Path=Count,
                                      Converter={StaticResource CountToVisibility}, ConverterParameter=Invert:1}">
            <TextBlock Text="Nic není vybráno" FontWeight="SemiBold" Margin="0,0,0,8"/>
            <TextBlock Text="Tip: Ctrl-klik přidá/odebere položku výběru."/>
        </StackPanel>

        <!-- Jedna položka -->
        <ContentControl Visibility="{Binding Source={StaticResource SelectionService}, Path=Count,
                                        Converter={StaticResource CountToVisibility}, ConverterParameter=1}">
            <ContentControl.Content>
                <Binding Source="{StaticResource SelectionService}" Path="SelectedItems[0]"/>
            </ContentControl.Content>

            <ContentControl.Resources>
                <!-- Základ pro všechna pole -->
                <DataTemplate DataType="{x:Type m:FieldComponentBase}">
                    <StackPanel>
                        <TextBlock Text="Základní" FontWeight="SemiBold" Margin="0,0,0,8"/>
                        <UniformGrid Columns="2" Margin="0,0,0,8">
                            <TextBlock Text="FieldKey"/>
                            <TextBox Text="{Binding FieldKey, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Label"/>
                            <TextBox Text="{Binding Label, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Placeholder"/>
                            <TextBox Text="{Binding Placeholder, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Required"/>
                            <CheckBox IsChecked="{Binding Required, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Default"/>
                            <TextBox Text="{Binding DefaultValue, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Šířka"/>
                            <TextBox Text="{Binding Width, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Výška"/>
                            <TextBox Text="{Binding Height, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Z-index"/>
                            <TextBox Text="{Binding ZIndex, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="X"/>
                            <TextBox Text="{Binding X, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Y"/>
                            <TextBox Text="{Binding Y, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:LabelField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Velikost písma"/>
                            <TextBox Text="{Binding FontSize, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:TextBoxField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Max délka"/>
                            <TextBox Text="{Binding MaxLength, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:TextAreaField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Řádků"/>
                            <TextBox Text="{Binding Rows, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:ComboBoxField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Editable"/>
                            <CheckBox IsChecked="{Binding IsEditable, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>

                        <TextBlock Text="Možnosti (Enter přidá)" Margin="0,8,0,4" FontStyle="Italic"/>
                        <ItemsControl ItemsSource="{Binding Options}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <DockPanel LastChildFill="True">
                                        <Button Content="×" DockPanel.Dock="Right" Margin="4,0" Padding="2"
                            CommandParameter="{Binding .}" Click="RemoveOption_Click"/>
                                        <TextBox Text="{Binding .}" />
                                    </DockPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <TextBox Margin="0,6,0,0" KeyDown="AddOption_KeyDown" Tag="{Binding}"/>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:CheckBoxField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Checked default"/>
                            <CheckBox IsChecked="{Binding IsCheckedDefault, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:DateField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Formát"/>
                            <TextBox Text="{Binding Format, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate DataType="{x:Type m:NumberField}">
                    <StackPanel>
                        <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource {x:Type m:FieldComponentBase}}"/>
                        <UniformGrid Columns="2">
                            <TextBlock Text="Min"/>
                            <TextBox Text="{Binding Min, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Max"/>
                            <TextBox Text="{Binding Max, UpdateSourceTrigger=PropertyChanged}"/>
                            <TextBlock Text="Desetinná místa"/>
                            <TextBox Text="{Binding Decimals, UpdateSourceTrigger=PropertyChanged}"/>
                        </UniformGrid>
                    </StackPanel>
                </DataTemplate>
            </ContentControl.Resources>
        </ContentControl>

        <!-- Více vybraných -->
        <StackPanel Visibility="{Binding Source={StaticResource SelectionService}, Path=Count,
                                      Converter={StaticResource CountToVisibility}, ConverterParameter=2}">
            <TextBlock Text="{Binding Source={StaticResource SelectionService}, Path=Count, StringFormat={}{0} vybraných}" FontWeight="SemiBold" Margin="0,0,0,8"/>
            <TextBlock Text="Použij horní ‚floating‘ nabídku pro hromadné akce."/>
        </StackPanel>
    </Grid>
</UserControl>
